{{define "login_content"}}
  <section style="position:fixed;top:0;left:0;width:100%;height:100%;display:flex;align-items:center;justify-content:center;background:inherit;">
    <div style="width:min(460px, calc(100% - 3rem));">
    <div class="card" style="padding:1.5rem 1.5rem 1.25rem;">
      <div style="display:flex;align-items:flex-start;justify-content:space-between;gap:1rem;">
        <div style="display:flex;align-items:center;gap:0.75rem;">
          <img src="/static/favicon.png" alt="ApiMe" width="32" height="32" style="display:block;"  aria-hidden="true">
          <h1 style="margin:0;letter-spacing:-0.02em;">ApiMe</h1>
        </div>
        <button type="button" id="themeToggleLogin" aria-label="Alternar tema" title="Alternar tema" style="background:none;border:none;cursor:pointer;padding:8px;color:currentColor;">
          <svg id="themeIconSun" width="24" height="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" style="display:none;">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M12 12m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0" />
            <path d="M3 12h1" />
            <path d="M12 3v1" />
            <path d="M20 12h1" />
            <path d="M12 20v1" />
            <path d="M5.6 5.6l.7 .7" />
            <path d="M18.4 5.6l-.7 .7" />
            <path d="M17.7 17.7l.7 .7" />
            <path d="M6.3 17.7l-.7 .7" />
          </svg>
          <svg id="themeIconMoon" width="24" height="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="#6b7280" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
          </svg>
          <svg id="themeIconSunMoon" width="24" height="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" style="display:none;">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M9.173 14.83a4 4 0 1 1 5.657 -5.657" />
            <path d="M11.294 12.707l.174 .247a7.5 7.5 0 0 0 8.845 2.492a9 9 0 0 1 -14.671 2.914" />
          </svg>
        </button>
      </div>

      <div style="height:1px;background:var(--border);margin:1.2rem 0 1.15rem;"></div>

      <form method="post" action="/dashboard/login" autocomplete="on">
        <div style="width:100%;">
          <label for="email" style="position:absolute;left:-9999px;">E-mail</label>
          <div style="position:relative;width:100%;">
            <span aria-hidden="true" style="position:absolute;left:0.95rem;top:50%;transform:translateY(-50%);opacity:0.75;">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M4 6h16v12H4V6Z" stroke="currentColor" stroke-width="1.8" stroke-linejoin="round"/>
                <path d="m4 7 8 6 8-6" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </span>
            <input style="padding-left:2.9rem;width:100%;box-sizing:border-box;" type="email" id="email" name="email" placeholder="E-mail" inputmode="email" required autofocus>
          </div>
        </div>

        <div style="width:100%;margin-top:0.75rem;">
          <label for="password" style="position:absolute;left:-9999px;">Senha</label>
          <div style="position:relative;width:100%;">
            <span aria-hidden="true" style="position:absolute;left:0.95rem;top:50%;transform:translateY(-50%);opacity:0.75;">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M7 11V8a5 5 0 0 1 10 0v3" stroke="currentColor" stroke-width="1.8" stroke-linecap="round"/>
                <path d="M6.5 11h11a1.5 1.5 0 0 1 1.5 1.5v6A1.5 1.5 0 0 1 17.5 20h-11A1.5 1.5 0 0 1 5 18.5v-6A1.5 1.5 0 0 1 6.5 11Z" stroke="currentColor" stroke-width="1.8"/>
              </svg>
            </span>
            <input style="padding-left:2.9rem;padding-right:3.2rem;width:100%;box-sizing:border-box;" type="password" id="password" name="password" placeholder="Senha" required>
            <button type="button" id="togglePassword" aria-label="Mostrar senha" title="Mostrar senha" style="position:absolute;right:0.55rem;top:50%;transform:translateY(-50%);border:none;background:transparent;color:inherit;opacity:0.7;cursor:pointer;padding:0.2rem;">
              <svg id="eyeIcon" width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                <path d="M2 12s3.5-7 10-7 10 7 10 7-3.5 7-10 7S2 12 2 12Z" stroke="currentColor" stroke-width="1.8" stroke-linejoin="round"/>
                <path d="M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z" stroke="currentColor" stroke-width="1.8"/>
              </svg>
              <svg id="eyeOffIcon" width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" style="display:none;">
                <path d="M9.88 9.88a3 3 0 1 0 4.24 4.24" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M10.73 5.08A10.54 10.54 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a13.5 13.5 0 0 0 5.17-1.03" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="m2 2 20 20" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </button>
          </div>
        </div>

        <button type="submit" id="loginBtn" style="margin-top:0.75rem;width:100%;display:inline-flex;align-items:center;justify-content:center;gap:0.55rem;">
          <svg id="loginIcon" width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M9 8v-2a2 2 0 0 1 2 -2h7a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-7a2 2 0 0 1 -2 -2v-2" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M3 12h13l-3 -3" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M13 15l3 -3" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          <span id="loginSpinner" class="loading-spinner" aria-hidden="true" style="display:none;"></span>
          <span id="loginText">Acessar</span>
        </button>
      </form>
    </div>
    </div>
  </section>

  <script>
    (function () {
      function getTheme() {
        try {
          var saved = localStorage.getItem('apime_theme');
          if (saved === 'light' || saved === 'dark') return saved;
        } catch (_) {}
        return (window.matchMedia && window.matchMedia('(prefers-color-scheme: light)').matches) ? 'light' : 'dark';
      }

      var toggle = document.getElementById('togglePassword');
      var input = document.getElementById('password');
      var eyeIcon = document.getElementById('eyeIcon');
      var eyeOffIcon = document.getElementById('eyeOffIcon');
      if (toggle && input && eyeIcon && eyeOffIcon) {
        toggle.addEventListener('click', function () {
          var isHidden = input.getAttribute('type') === 'password';
          input.setAttribute('type', isHidden ? 'text' : 'password');
          toggle.setAttribute('aria-label', isHidden ? 'Ocultar senha' : 'Mostrar senha');
          toggle.setAttribute('title', isHidden ? 'Ocultar senha' : 'Mostrar senha');
          eyeIcon.style.display = isHidden ? 'none' : 'block';
          eyeOffIcon.style.display = isHidden ? 'block' : 'none';
        });
      }

      var themeToggle = document.getElementById('themeToggleLogin');
      function syncThemeIcon() {
        var cur = document.documentElement.getAttribute('data-theme') || 'dark';
        var sun = document.getElementById('themeIconSun');
        var moon = document.getElementById('themeIconMoon');
        var sunmoon = document.getElementById('themeIconSunMoon');
        if (sun && moon && sunmoon) {
          sun.style.display = cur === 'dark' ? 'block' : 'none';
          moon.style.display = cur === 'light' ? 'block' : 'none';
          sunmoon.style.display = 'none';
        }
      }

      var theme = getTheme();
      document.documentElement.setAttribute('data-theme', theme);
      syncThemeIcon();
      
      if (themeToggle) {
        themeToggle.addEventListener('click', function () {
          var cur = document.documentElement.getAttribute('data-theme') || 'dark';
          var next = cur === 'dark' ? 'light' : 'dark';
          document.documentElement.setAttribute('data-theme', next);
          try { localStorage.setItem('apime_theme', next); } catch (_) {}
          setTimeout(syncThemeIcon, 0);
        });
      }

      var loginBtn = document.getElementById('loginBtn');
      var loginIcon = document.getElementById('loginIcon');
      var loginSpinner = document.getElementById('loginSpinner');
      var loginText = document.getElementById('loginText');
      var loginForm = document.querySelector('form[method="post"]');

      if (loginForm && loginBtn) {
        loginForm.addEventListener('submit', function (e) {

          var email = document.getElementById('email').value.trim();
          var password = document.getElementById('password').value;
          
          if (!email || !password) {
            return;
          }


          loginBtn.disabled = true;
          loginIcon.style.display = 'none';
          loginSpinner.style.display = 'inline-block';
          loginText.textContent = 'Acessando...';
        });
      }
    })();
  </script>
{{end}}

